@(access: service.Access,
	course: models.organization.Course,
    quiz: models.quiz.Quiz,
    answerOp: Option[models.quiz.answer.Answer],
    derivativeForm: Form[controllers.quiz.derivative.DerivativeQuestionForm],
    derivativeGraphForm: Form[controllers.quiz.derivativegraph.DerivativeGraphQuestionForm],
    tangentForm: Form[controllers.quiz.tangent.TangentQuestionForm])(implicit user: models.user.User, session: play.api.db.slick.Config.driver.simple.Session)

@import controllers.quiz.routes.{ QuestionsController, QuizzesController}
@import controllers.quiz.QuizForm
@import helper._
@import com.artclod.play.{are, s}

@mainWithBorder("Quiz " + quiz.name, tag.courseLink(course)) {

    <h2>Welcome to the page for quiz: @quiz.name </h2>

    @if(access.write){
    @form(QuizzesController.rename(course.organizationId, course.id, quiz.id), 'class -> "pure-form") {
        To rename type a new name here <input type="text" name="@QuizForm.name" value="@quiz.name">
        and click <input class="pure-button" type="submit" value="rename" >
    }
    }

    @views.html.quiz.questionCreationError(tangentForm)

    @defining(quiz.results(user)){ results =>
    @defining(results.questions){ questions =>

    <h4>There @are(questions) @questions.size Question@s(questions) in the quiz @tag.icon("icon-help", 'data_ot -> "Click a question to answer it")</h4>

    <table class="pure-table pure-table-striped">
        <tr>
    	    <th>Question</th>
            <th>Status</th>
            @if(access.write){<th> Remove </th>}
        </tr>
        @for(result <- results.results){<tr>
            <td> <a class="pure-button" href="@QuestionsController.view(course.organizationId, course.id, quiz.id, result.question.id)"> @result.question.display() </a> </td>
            <td> @tag.status(result.status) @tag.maybeIndicateCorrect(result.question, answerOp) </td>
            @if(access.write){<td> @form(QuestionsController.remove(course.organizationId, course.id, quiz.id, result.question.id), 'class -> "pure-form") { <input class="pure-button" type="submit" value="remove" > } </td> }
        </tr>}
    </table>
    }
    }

    @if(access.write){
    <h4>Add a new Question</h4>

    @tag.switch("createQuestion", com.artclod.play.errorIndex(derivativeForm, derivativeGraphForm, tangentForm),
        ("Create a Derivative Question", views.html.quiz.derivative.questionEditor(QuestionsController.createDerivative(course.organizationId, course.id, quiz.id))),
        ("Create a Derivative Graph Question", views.html.quiz.derivativegraph.questionEditor(QuestionsController.createDerivativeGraph(course.organizationId, course.id, quiz.id), derivativeGraphForm)),
        ("Create a Tangent Question", views.html.quiz.tangent.questionEditor(QuestionsController.createTangent(course.organizationId, course.id, quiz.id), tangentForm))
    )

    @defining(quiz.results(course)) { quizResults =>
    <section>
        <h4>Summary of student results</h4>
        <ul>
        @for(result <- quizResults) {
            <li> @{result.student.nameDisplay}'s score was @tag.percentOp(result.score)</li>
        }
        </ul>
    </section>
    }
    }

}
