 @(question: derivative.Question, answer: Option[derivative.Answer], questionSet: Option[derivative.Quiz])(implicit user: service.User)

@import helper._
@import controllers.question.derivative._ 
 
@main("Answer a Self Quiz Question") {
	
	@if(questionSet.isEmpty){
    <div>
    	<a href="@routes.QuestionController.questions"> Back to the list of questions</a>
    </div>
    } else {
    <div>
    	<a href="@routes.QuizController.setAnswer(questionSet.get.id)"> Back to the question set "@questionSet.get.name" </a>
    </div>
    }
    
    <div>
	    <h2>What is the Derivative of</h2>
    	<script type="math/mml"> @Html(question.mathML.toString) </script>
	</div>
	<p>
	
	@if(answer.nonEmpty){
	<div>
		Answer @Html(answer.get.id.toString) to this questions was <script type="math/mml"> @Html(answer.get.mathML.toString) </script> <br>
		That answer was @if(answer.get.correct){ <font color="green"> correct </font> } else { <font color="red"> incorrect </font> }
	</div>
	<p>
	}	
    
    <div>
		Type in your answer, and then hit the submit button <br> 
		@mathml_editor("ANSWER")
	</div>
		
	<div>
	@form(routes.AnswerController.newAnswer(question.id, questionSet.map(_.id)) , 'id -> "answerForm" ) {
    	<input type="hidden" name="@AnswerHTML.mathML" id="answerMathML">
    	<input type="hidden" name="@AnswerHTML.rawStr" id="answerRawStr">
    	<input type="hidden" name="@AnswerHTML.current" id="answerCurrent">
    	<input type="button" value="Submit" onclick="answerFormSubmit()">
    }
    </div>
	
	<script>
	var answerFormSubmit = function() {
		if(ANSWER.valid){
			$("#answerMathML").val(ANSWER.mathML);
			$("#answerRawStr").val(ANSWER.rawStr);
			$("#answerCurrent").val(ANSWER.current);
			$("#answerForm").submit();
		}
		// TODO indicated that the form did not submit
	}
    </script>
}
